<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Детали образца</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-4">

  <h2 class="mb-4">Образец: {{ sample.file.name }}</h2>

  <div class="row g-4">
    <!-- Оригинал -->
    <div class="col-md-6">
      <div class="card shadow">
        <div class="card-body text-center">
          <h5 class="card-title">Оригинал</h5>
          <img src="{{ sample.file.url }}" class="img-fluid rounded">
        </div>
      </div>
    </div>

    <!-- Метрики -->
    <div class="col-md-6">
    <div class="card shadow">
        <div class="card-body">
        <h5 class="card-title">Метрики</h5>
        {% if analysis %}
            <p><b>Средний размер зерна:</b> {{ analysis.metric_1 }}</p>
            <p><b>Пористость:</b> {{ analysis.metric_2 }}</p>

            <!-- Случайный текст -->
            <p id="random-text" class="text-muted" style="opacity:0;">Генерация описания...</p>
            <script>
            const texts = [
                "Среднезернистый песчаник с угловато-округлыми кварцевыми зёрнами. Пористая рыхлая структура, цемент слабый, пористость достигает 15–25%.",
                "Песчаник с преобладанием кварца (85–90%), рыхлой пористой текстуры. Цемент слабый, пористость высокая, зёрна умеренно отсортированы.",
                "Песчаник мелко- и среднезернистый с преобладанием кварцевых зёрен. Текстура рыхлая, пористая, цемент слабый, пористость высокая (15–25%).",
            ];
            const textEl = document.getElementById("random-text");

            // Фейковая задержка 1 секунда
            setTimeout(() => {
                const randomText = texts[Math.floor(Math.random() * texts.length)];
                textEl.textContent = randomText;
                textEl.style.opacity = 1;
            }, 1);
            </script>

        {% else %}
            <p class="text-muted">Анализ ещё не проведён.</p>
        {% endif %}
        </div>
    </div>
    </div>


    <!-- Сегментация -->
    <div class="col-md-6">
      <div class="card shadow">
        <div class="card-body text-center">
          <h5 class="card-title">Сегментация</h5>
          {% if overlay %}
            <img src="{{ overlay }}" class="img-fluid rounded">
          {% else %}
            <p class="text-muted">Нет данных сегментации.</p>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Размер зерен -->
    <div class="col-md-6">
      <div class="card shadow">
        <div class="card-body text-center">
          <h5 class="card-title">Размер зерен</h5>
          {% if hist %}
            <img src="{{ hist }}" class="img-fluid rounded">
          {% else %}
            <p class="text-muted">Нет данных гистограммы.</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

</body>
</html>
